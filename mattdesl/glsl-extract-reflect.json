{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/mattdesl/glsl-extract-reflect\">glsl-extract-reflect</a><div class=\"contrib\"></div></h1>\n<p><a href=\"http://github.com/badges/stability-badges\"></a></p>\n<p>Takes the type data from <a href=\"https://www.npmjs.com/package/glsl-extract\">glsl-extract</a> and transforms the names into a JSON structure where each leaf node is the return value of the given <code>map</code> function.</p>\n<p>This is useful to create wrappers for uniform and attribute structs/arrays.</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span class=\"storage modifier js\"><span>var</span></span><span>&#xA0;reflect&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"support function js\"><span>require</span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>glsl-extract-reflect</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage modifier js\"><span>var</span></span><span>&#xA0;uniforms&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"meta brace square js\"><span>[</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span><span>&#xA0;name</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>lights[0].position</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;type</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>vec4</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span><span>&#xA0;name</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>projection</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;type</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>mat4</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span><span>&#xA0;name</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>color</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;type</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>vec3</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"meta brace square js\"><span>]</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage modifier js\"><span>var</span></span><span>&#xA0;locations&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;reflect</span><span class=\"meta brace round js\"><span>(</span></span><span>uniforms</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"meta function js\"><span class=\"storage type function js\"><span>function</span></span><span>&#xA0;</span><span class=\"punctuation definition parameters begin js\"><span>(</span></span><span class=\"variable parameter function js\"><span>uniform</span></span><span class=\"punctuation definition parameters end js\"><span>)</span></span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"keyword control js\"><span>return</span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;type</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;uniform</span><span class=\"meta delimiter method period js\"><span>.</span></span><span class=\"support constant dom js\"><span>type</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;location</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;gl</span><span class=\"meta delimiter method period js\"><span>.</span></span><span>getUniformLocation</span><span class=\"meta brace round js\"><span>(</span></span><span>program</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;uniform</span><span class=\"meta delimiter method period js\"><span>.</span></span><span>path</span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>}</span></span><span class=\"meta brace round js\"><span>)</span></span></span></div>\n</code></pre>\n<p>The <code>locations</code> result looks like this:</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>lights</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"meta brace square js\"><span>[</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>position</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>type</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>vec4</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>location</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace square js\"><span>]</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>projection</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>type</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>mat4</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>location</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>color</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>type</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>vec3</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>location</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>}</span></span></span></div>\n</code></pre>\n<p>Credit goes to @mikolalysenko; this was pulled out of <a href=\"https://github.com/stackgl/gl-shader\">gl-shader</a> and made a little more generic.</p>\n<h2 id=\"usage\">Usage</h2>\n<p><a href=\"https://www.npmjs.com/package/glsl-extract-reflect\"></a></p>\n<h4 id=\"-result-reflect-array-map-\"><code>result = reflect(array, map)</code></h4>\n<p>Takes an <code>array</code> of uniforms or attributes with <code>{ name, type }</code> values, and returns the &quot;unflattened&quot; object for all structs and arrays. Each leaf node is the result of calling <code>map(data, index, array)</code>, where <code>data</code> has the following:</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;name</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>radius</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;the&#xA0;standalone&#xA0;uniform&#xA0;name</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;path</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>lights[0].radius</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;</span><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;the&#xA0;qualified&#xA0;name&#xA0;used&#xA0;by&#xA0;WebGL</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;type</span><span class=\"keyword operator js\"><span>:</span></span><span>&#xA0;</span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>float</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;the&#xA0;original&#xA0;type</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;</span><span class=\"meta delimiter method period js\"><span>.</span><span>.</span><span>.</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>}</span></span></span></div>\n</code></pre>\n<p>Other values (like <code>location</code>) are also copied into the <code>data</code> object.</p>\n<h2 id=\"see-also\">See Also</h2>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/glsl-extract-sync\">glsl-extract-sync</a></li>\n<li><a href=\"https://www.npmjs.com/package/gl-shader-extract\">gl-shader-extract</a> (extracts during runtime)</li>\n</ul>\n<h2 id=\"license\">License</h2>\n<p>MIT, see <a href=\"http://github.com/mattdesl/glsl-extract-reflect/blob/master/LICENSE.md\">LICENSE.md</a> for details.</p>\n"}