<h1 id="gl-particles"><a target="_blank" href="http://github.com/stackgl/gl-particles">gl-particles</a></h1>
<p><a href="http://github.com/badges/stability-badges"></a></p>
<p>Convenience module for FBO-driven particle simulations.</p>
<p><strong><a href="http://stack.gl/gl-particles/">view demo</a></strong></p>
<iframe scrolling="no" seamless="seamless" src="http://stack.gl/gl-particles/"></iframe><h2 id="usage">Usage</h2>
<p><a href="https://nodei.co/npm/gl-particles/"></a></p>
<p>See <a href="demo.js">demo.js</a> for a full example.</p>
<h3 id="-particles-particles-gl-options-"><code>particles = Particles(gl, options)</code></h3>
<p>Creates a new particle simulation given a WebGLContext <code>gl</code> and set
of <code>options</code>:</p>
<ul>
<li><code>logic</code>: the logic shader for simulating the particles, as a string. Required.</li>
<li><code>vert</code>: the vertex shader responsible for determining the rendered particles&apos;
position and size. Required.</li>
<li><code>frag</code>: the fragment shader responsible for determining the color/texture of
each particle. Required.</li>
<li><code>shape</code>: a <code>[width, height]</code> array for the dimensions of the particle texture.
This determines the total amount of particles, which should be <code>width * height</code>.
Defaults to <code>[64, 64]</code>.</li>
</ul>
<p>Your logic shader will automatically be assigned the following uniforms:</p>
<ul>
<li><code>sampler2D data</code>: the particle data texture.</li>
<li><code>vec2 resolution</code>: the width/height of the data texture.</li>
</ul>
<p>And your fragment/vertex shaders will be assigned the following:</p>
<ul>
<li><code>sampler2D data</code>: the particle data texture.</li>
</ul>
<h3 id="-particles-populate-u-v-vec4-"><code>particles.populate((u, v, vec4) =&gt;)</code></h3>
<p>Populates the data for each particle in your FBO textures individually.</p>
<ul>
<li><code>u</code> is the horizontal index of the particle in pixels.</li>
<li><code>v</code> is the vertical index of the particle in pixels.</li>
<li><code>vec4</code> is a 4-element array which you should modify in-place to update
the current particle&apos;s values.</li>
</ul>
<p>For example, if you have 2D positions for your particles you would set them
randomly like so:</p>
<pre><code class="lang-javascript"><span class="nx">particles</span><span class="p">.</span><span class="nx">populate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">vec4</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">vec4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
  <span class="nx">vec4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="p">})</span>
</code></pre>
<h3 id="-particles-step-uniforms-"><code>particles.step((uniforms) =&gt;)</code></h3>
<p>Runs one step of the <code>logic</code> shader &#x2013; should generally be done once per
frame.</p>
<p>You may optionally pass in a function to update the shader&apos;s uniforms, e.g.:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>

<span class="nx">particles</span><span class="p">.</span><span class="nx">step</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">uniforms</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">uniforms</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>
<span class="p">})</span>
</code></pre>
<p><em>Note that this will modify your WebGL state. Specifically, it will reset
your current framebuffer, viewport and shader.</em></p>
<h3 id="-particles-draw-uniforms-"><code>particles.draw((uniforms) =&gt;)</code></h3>
<p>Draws your particles to the screen using the <code>vert</code> and <code>frag</code> shaders.</p>
<p>As with <code>particles.step</code>, you may pass in an optional function for updating
the shader&apos;s uniforms.</p>
<h3 id="-particles-setlogicshader-logicshadersource-"><code>particles.setLogicShader(logicShaderSource)</code></h3>
<p>Change the logic shader to <code>logicShaderSource</code>.</p>
<h2 id="contributing">Contributing</h2>
<p>See <a href="https://github.com/stackgl/contributing">stackgl/contributing</a> for details.</p>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/stackgl/gl-particles/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
