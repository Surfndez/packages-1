<h1 id="glsl-face-normal"><a target="_blank" href="http://github.com/stackgl/glsl-face-normal">glsl-face-normal</a></h1>
<p><a href="http://github.com/badges/stability-badges"></a></p>
<p><img src="http://i.imgur.com/PFaEL8y.png" alt="demo-image"></p>
<p><a href="http://stack.gl/glsl-face-normal/demo">(click for demo)</a></p>
<iframe scrolling="no" seamless="seamless" src="http://stack.gl/glsl-face-normal/demo"></iframe>

<p>Approximates face normals in the fragment shader for flat shading from the position in camera space.</p>
<p><em>Note:</em> You need to enable <code>GL_OES_standard_derivatives</code>.</p>
<p>Fragment:</p>
<pre><code class="lang-glsl"><span class="cp">#extension GL_OES_standard_derivatives : enable</span>
<span class="k">varying</span> <span class="k">vec3</span> <span class="n">vViewPos</span><span class="p">;</span>

<span class="cp">#pragma glslify: faceNormal = require(&apos;glsl-face-normal&apos;)</span>

<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">vec3</span> <span class="n">normal</span> <span class="o">=</span> <span class="n">faceNormal</span><span class="p">(</span><span class="n">vViewPos</span><span class="p">);</span>
  <span class="c1">//... lighting</span>
<span class="p">}</span>
</code></pre>
<p>Vertex: </p>
<pre><code class="lang-glsl"><span class="k">varying</span> <span class="k">vec3</span> <span class="n">vViewPos</span><span class="p">;</span>

<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">vec4</span> <span class="n">pos</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
  <span class="k">vec4</span> <span class="n">mpos</span> <span class="o">=</span> <span class="n">modelViewMatrix</span> <span class="o">*</span> <span class="n">pos</span><span class="p">;</span>
  <span class="n">gl_Position</span> <span class="o">=</span> <span class="n">projectionMatrix</span> <span class="o">*</span> <span class="n">mpos</span><span class="p">;</span>
  <span class="n">vViewPos</span> <span class="o">=</span> <span class="o">-</span><span class="n">mpos</span><span class="p">.</span><span class="n">xyz</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<h2 id="usage">Usage</h2>
<p><a href="https://nodei.co/npm/glsl-face-normal/"></a></p>
<h4 id="-vec3-normal-facenormal-vec3-pos-"><code>vec3 normal = faceNormal(vec3 pos)</code></h4>
<p>Approximates the face <code>normal</code> from the given <code>pos</code>, which is typically the position in camera-space.</p>
<p>For better precision, you can use the <a href="http://www.enkisoftware.com/devlogpost-20150131-1-Normal_generation_in_the_pixel_shader.html">eye relative position</a> instead.</p>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/stackgl/glsl-face-normal/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
