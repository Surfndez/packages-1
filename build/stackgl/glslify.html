<h1 id="glslify"><a target="_blank" href="http://github.com/stackgl/glslify">glslify</a></h1>
<p><a href="http://github.com/badges/stability-badges"></a></p>
<p>A node.js-style module system for GLSL!</p>
<p>This module contains glslify&apos;s command-line interface (CLI) and
<a href="http://browserify.org/">browserify</a> transform. It forms one of the core
components of the <a href="http://stack.gl/">stack.gl</a> ecosystem, allowing you to
install GLSL modules from <a href="http://npmjs.com">npm</a> and use them in your
shaders. This makes it trivial to piece together different effects and
techniques from the community, including but certainly not limited to
<a href="https://github.com/hughsk/glsl-fog">fog</a>,
<a href="https://github.com/hughsk/glsl-noise">noise</a>,
<a href="https://github.com/mattdesl/glsl-film-grain">film grain</a>,
<a href="https://github.com/stackgl/glsl-smooth-min">raymarching helpers</a>,
<a href="https://github.com/stackgl/glsl-easings">easing functions</a> and
<a href="https://github.com/stackgl/glsl-specular-cook-torrance">lighting models</a>.</p>
<p>A full list can be found on the <a href="http://stack.gl/packages">stack.gl packages list</a>
under the &quot;Shader Components&quot; category.</p>
<p>Because glslify just outputs a single shader file as a string, it&apos;s easy to use
it with any WebGL framework of your choosing,
provided they accept custom shaders. Integration is planned for
<a href="http://threejs.org/">three.js</a>, <a href="http://webpack.github.io/">webpack</a> and
<a href="http://vorg.github.io/pex/">pex</a>, with more on the way!
<a href="https://github.com/stackgl/glslify/issues/new">Open an issue</a> here if you&apos;d like to
discuss integrating glslify with your platform of choice.</p>
<h2 id="installation">Installation</h2>
<p><a href="https://nodei.co/npm/glslify/"></a></p>
<p>To install the command-line interface, install glslify globally like
so:</p>
<pre><code class="lang-bash">npm install -g glslify
</code></pre>
<p>To install glslify for use as a browserify transform, you should
install it locally instead:</p>
<pre><code class="lang-bash">npm install glslify
</code></pre>
<h2 id="getting-started">Getting Started</h2>
<h3 id="cli">CLI</h3>
<p>The CLI can take a file as its first argument, and output to a file
using the <code>-o</code> flag:</p>
<pre><code class="lang-bash">glslify index.glsl -o output.glsl
</code></pre>
<p>It can also read input from stdin and output to stdout:</p>
<pre><code class="lang-bash">cat index.glsl <span class="p">|</span> glslify &gt; output.glsl
</code></pre>
<h3 id="browserify-transform">Browserify Transform</h3>
<p>If using browserify from the command-line, simply pass glslify
in as a transform using the <code>-t</code>/<code>--transform</code> flag:</p>
<pre><code class="lang-bash">browserify -t glslify index.js -o bundle.js
</code></pre>
<p>Alternatively, you may include glslify as a <code>browserify.transform</code>
in your <code>package.json</code> file:</p>
<pre><code class="lang-json"><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-app&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;glslify&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.0.0&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;browserify&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;transform&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;glslify&quot;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>When writing your app, you should be able to require and call
glslify like so:</p>
<pre><code class="lang-javascript"><span class="c1">// index.js</span>
<span class="kd">var</span> <span class="nx">glslify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glslify&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">src</span> <span class="o">=</span> <span class="nx">glslify</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&apos;/shader.glsl&apos;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span>
</code></pre>
<p>Your glslify calls will be replaced with bundled GLSL strings
at build time automatically for you!</p>
<pre><code class="lang-javascript"><span class="c1">// index.js</span>
<span class="kd">var</span> <span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;#define GLSLIFY 1\n\nprecision mediump float; ...&quot;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span>
</code></pre>
<h3 id="inline-mode">Inline mode</h3>
<p>By passing the <code>inline</code> option as true, you can write your
shader inline instead of requiring it to be in a separate
file:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">glslify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glslify&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">src</span> <span class="o">=</span> <span class="nx">glslify</span><span class="p">(</span><span class="err">`</span>
  <span class="nx">precision</span> <span class="nx">mediump</span> <span class="kr">float</span><span class="p">;</span>

  <span class="k">void</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">gl_FragColor</span> <span class="o">=</span> <span class="nx">vec4</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
  <span class="p">}</span>
<span class="err">`</span><span class="p">,</span> <span class="p">{</span> <span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
</code></pre>
<h3 id="-webpack-http-webpack-github-io-loader"><a href="http://webpack.github.io/">Webpack</a> Loader</h3>
<p>You can use the
<a href="https://github.com/stackgl/glslify-loader">glslify-loader</a>
module to bundle shaders through glslify with Webpack. Check out
<a href="https://github.com/stackgl/glslify-loader">the repository</a>
for further information.</p>
<h2 id="usage">Usage</h2>
<h3 id="installing-a-glsl-module">Installing a GLSL Module</h3>
<p>Much like plain JavaScript modules, GLSL modules are stored on npm.
The main difference is that GLSL modules contain an <code>index.glsl</code> file
instead of an <code>index.js</code>. Generally, these modules start with <code>glsl-</code>
in their name.</p>
<p>To install <a href="https://github.com/hughsk/glsl-noise">glsl-noise</a> in
your current directory:</p>
<pre><code class="lang-bash">npm install glsl-noise
</code></pre>
<p>This will download glsl-noise and any of its dependencies, placing
them in a <code>node_modules</code> directory for glslify to use.</p>
<h3 id="importing-a-glsl-module">Importing a GLSL Module</h3>
<p>You can import a module using the following <code>#pragma</code> syntax:</p>
<pre><code class="lang-glsl"><span class="cp">#pragma glslify: noise = require(glsl-noise/simplex/2d)</span>

<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">float</span> <span class="n">brightness</span> <span class="o">=</span> <span class="n">noise</span><span class="p">(</span><span class="n">gl_FragCoord</span><span class="p">.</span><span class="n">xy</span><span class="p">);</span>

  <span class="n">gl_FragColor</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="k">vec3</span><span class="p">(</span><span class="n">brightness</span><span class="p">),</span> <span class="mf">1.</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
<p>Shader dependencies are resolved using the same algorithm
as node, so the above will load <code>./node_modules/simplex/2d.glsl</code>
from the shader&apos;s directory.</p>
<p>The above example would result in the following output:</p>
<pre><code class="lang-glsl"><span class="cp">#define GLSLIFY 1</span>

<span class="c1">//</span>
<span class="c1">// Description : Array and textureless GLSL 2D simplex noise function.</span>
<span class="c1">//      Author : Ian McEwan, Ashima Arts.</span>
<span class="c1">//  Maintainer : ijm</span>
<span class="c1">//     Lastmod : 20110822 (ijm)</span>
<span class="c1">//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.</span>
<span class="c1">//               Distributed under the MIT License. See LICENSE file.</span>
<span class="c1">//               https://github.com/ashima/webgl-noise</span>
<span class="c1">//</span>

<span class="k">vec3</span> <span class="n">mod289_1_0</span><span class="p">(</span><span class="k">vec3</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">289.0</span><span class="p">))</span> <span class="o">*</span> <span class="mf">289.0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">vec2</span> <span class="n">mod289_1_0</span><span class="p">(</span><span class="k">vec2</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">289.0</span><span class="p">))</span> <span class="o">*</span> <span class="mf">289.0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">vec3</span> <span class="n">permute_1_1</span><span class="p">(</span><span class="k">vec3</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">mod289_1_0</span><span class="p">(((</span><span class="n">x</span><span class="o">*</span><span class="mf">34.0</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">float</span> <span class="n">snoise_1_2</span><span class="p">(</span><span class="k">vec2</span> <span class="n">v</span><span class="p">)</span>
  <span class="p">{</span>
  <span class="k">const</span> <span class="k">vec4</span> <span class="n">C</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="mf">0.211324865405187</span><span class="p">,</span>  <span class="c1">// (3.0-sqrt(3.0))/6.0</span>
                      <span class="mf">0.366025403784439</span><span class="p">,</span>  <span class="c1">// 0.5*(sqrt(3.0)-1.0)</span>
                     <span class="o">-</span><span class="mf">0.577350269189626</span><span class="p">,</span>  <span class="c1">// -1.0 + 2.0 * C.x</span>
                      <span class="mf">0.024390243902439</span><span class="p">);</span> <span class="c1">// 1.0 / 41.0</span>
<span class="c1">// First corner</span>
  <span class="k">vec2</span> <span class="n">i</span>  <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">yy</span><span class="p">)</span> <span class="p">);</span>
  <span class="k">vec2</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span>   <span class="n">i</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">C</span><span class="p">.</span><span class="n">xx</span><span class="p">);</span>

<span class="c1">// Other corners</span>
  <span class="k">vec2</span> <span class="n">i1</span><span class="p">;</span>
  <span class="c1">//i1.x = step( x0.y, x0.x ); // x0.x &gt; x0.y ? 1.0 : 0.0</span>
  <span class="c1">//i1.y = 1.0 - i1.x;</span>
  <span class="n">i1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">x0</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">?</span> <span class="k">vec2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">:</span> <span class="k">vec2</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
  <span class="c1">// x0 = x0 - 0.0 + 0.0 * C.xx ;</span>
  <span class="c1">// x1 = x0 - i1 + 1.0 * C.xx ;</span>
  <span class="c1">// x2 = x0 - 1.0 + 2.0 * C.xx ;</span>
  <span class="k">vec4</span> <span class="n">x12</span> <span class="o">=</span> <span class="n">x0</span><span class="p">.</span><span class="n">xyxy</span> <span class="o">+</span> <span class="n">C</span><span class="p">.</span><span class="n">xxzz</span><span class="p">;</span>
  <span class="n">x12</span><span class="p">.</span><span class="n">xy</span> <span class="o">-=</span> <span class="n">i1</span><span class="p">;</span>

<span class="c1">// Permutations</span>
  <span class="n">i</span> <span class="o">=</span> <span class="n">mod289_1_0</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="c1">// Avoid truncation effects in permutation</span>
  <span class="k">vec3</span> <span class="n">p</span> <span class="o">=</span> <span class="n">permute_1_1</span><span class="p">(</span> <span class="n">permute_1_1</span><span class="p">(</span> <span class="n">i</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="k">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">i1</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">))</span>
    <span class="o">+</span> <span class="n">i</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="k">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">i1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">));</span>

  <span class="k">vec3</span> <span class="n">m</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="k">vec3</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">x0</span><span class="p">),</span> <span class="n">dot</span><span class="p">(</span><span class="n">x12</span><span class="p">.</span><span class="n">xy</span><span class="p">,</span><span class="n">x12</span><span class="p">.</span><span class="n">xy</span><span class="p">),</span> <span class="n">dot</span><span class="p">(</span><span class="n">x12</span><span class="p">.</span><span class="n">zw</span><span class="p">,</span><span class="n">x12</span><span class="p">.</span><span class="n">zw</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">);</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span> <span class="p">;</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span> <span class="p">;</span>

<span class="c1">// Gradients: 41 points uniformly over a line, mapped onto a diamond.</span>
<span class="c1">// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)</span>

  <span class="k">vec3</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">fract</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">C</span><span class="p">.</span><span class="n">www</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">vec3</span> <span class="n">h</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">;</span>
  <span class="k">vec3</span> <span class="n">ox</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">);</span>
  <span class="k">vec3</span> <span class="n">a0</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">ox</span><span class="p">;</span>

<span class="c1">// Normalise gradients implicitly by scaling m</span>
<span class="c1">// Approximation of: m *= inversesqrt( a0*a0 + h*h );</span>
  <span class="n">m</span> <span class="o">*=</span> <span class="mf">1.79284291400159</span> <span class="o">-</span> <span class="mf">0.85373472095314</span> <span class="o">*</span> <span class="p">(</span> <span class="n">a0</span><span class="o">*</span><span class="n">a0</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">h</span> <span class="p">);</span>

<span class="c1">// Compute final noise value at P</span>
  <span class="k">vec3</span> <span class="n">g</span><span class="p">;</span>
  <span class="n">g</span><span class="p">.</span><span class="n">x</span>  <span class="o">=</span> <span class="n">a0</span><span class="p">.</span><span class="n">x</span>  <span class="o">*</span> <span class="n">x0</span><span class="p">.</span><span class="n">x</span>  <span class="o">+</span> <span class="n">h</span><span class="p">.</span><span class="n">x</span>  <span class="o">*</span> <span class="n">x0</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
  <span class="n">g</span><span class="p">.</span><span class="n">yz</span> <span class="o">=</span> <span class="n">a0</span><span class="p">.</span><span class="n">yz</span> <span class="o">*</span> <span class="n">x12</span><span class="p">.</span><span class="n">xz</span> <span class="o">+</span> <span class="n">h</span><span class="p">.</span><span class="n">yz</span> <span class="o">*</span> <span class="n">x12</span><span class="p">.</span><span class="n">yw</span><span class="p">;</span>
  <span class="k">return</span> <span class="mf">130.0</span> <span class="o">*</span> <span class="n">dot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">g</span><span class="p">);</span>
<span class="p">}</span>




<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">float</span> <span class="n">brightness</span> <span class="o">=</span> <span class="n">snoise_1_2</span><span class="p">(</span><span class="n">gl_FragCoord</span><span class="p">.</span><span class="n">xy</span><span class="p">);</span>

  <span class="n">gl_FragColor</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="k">vec3</span><span class="p">(</span><span class="n">brightness</span><span class="p">),</span> <span class="mf">1.</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
<h3 id="exporting-a-glsl-module">Exporting a GLSL Module</h3>
<p>You can export a token from a module using the <code>glslify: export</code>
pragma, like so:</p>
<pre><code class="lang-glsl"><span class="k">float</span> <span class="n">myFunction</span><span class="p">(</span><span class="k">vec3</span> <span class="n">normal</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">dot</span><span class="p">(</span><span class="k">vec3</span><span class="p">(</span><span class="mo">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mo">0</span><span class="p">),</span> <span class="n">normal</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#pragma glslify: export(myFunction)</span>
</code></pre>
<p>This means that when you import this module file elsewhere, you&apos;ll
get <code>myFunction</code> in return:</p>
<pre><code class="lang-glsl"><span class="cp">#pragma glslify: topDot = require(./my-function.glsl)</span>

<span class="n">topDot</span><span class="p">(</span><span class="k">vec3</span><span class="p">(</span><span class="mo">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mo">0</span><span class="p">));</span> <span class="c1">// 1</span>
</code></pre>
<p>If you check the output shader source, you&apos;ll notice that variables
have been renamed to avoid conflicts between multiple shader files.</p>
<p>You&apos;re not limited to exporting functions either: you should be able
to export any GLSL token, such as a struct for reuse between your
modules:</p>
<pre><code class="lang-glsl"><span class="k">struct</span> <span class="n">Light</span> <span class="p">{</span>
  <span class="k">vec3</span> <span class="n">position</span><span class="p">;</span>
  <span class="k">vec3</span> <span class="n">color</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#pragma glslify: export(Light)</span>
</code></pre>
<h2 id="source-transforms">Source Transforms</h2>
<p>Source transforms are a feature inspired by browserify, allowing you to
modify your GLSL source at build time on a per-package basis. This is
useful both for transpilation (e.g. converting from or to
<a href="http://en.wikipedia.org/wiki/High-Level_Shading_Language">HLSL</a>) or for
making incremental improvements to GLSL syntax. (e.g. you can use
<a href="https://github.com/hughsk/glslify-hex">glslify-hex</a> to include CSS-style
hex strings for colors in place of <code>vec3</code>s).</p>
<p>There are three kinds of source transform:</p>
<ul>
<li><strong>Local transforms</strong>, the default. These are applied per-file, and only
applied to a single package. If you&apos;re defining it via the CLI using <code>-t</code>
it&apos;ll only apply itself to files outside of <code>node_modules</code>, but you
can include it in <code>package.json</code> too: these will be applied only to that
package without interfering with any of the package&apos;s parents or children.</li>
<li><strong>Global transforms</strong> are applied after local transforms to every file,
regardless of whether or not it&apos;s a dependency.</li>
<li><strong>Post transforms</strong> are applied to the entire output file once it&apos;s been
bundled. Generally, you want to reserve this for very specific use cases
such as whole-shader optimisation.</li>
</ul>
<p>There are a number of ways to use a transform. Start by
installing it in your project:</p>
<pre><code class="lang-bash">npm install --save glslify-hex
</code></pre>
<p>The preferred way to enable a transform is through your project&apos;s
<code>package.json</code> file&apos;s <code>glslify.transform</code> property, like so:</p>
<pre><code class="lang-json"><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-project&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;glslify-hex&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.0.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;glslify&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.0.0&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;glslify&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;transform&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;glslify-hex&quot;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>You may also include arguments to your transform as you would
with browserify:</p>
<pre><code class="lang-json"><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-project&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;glslify-hex&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.0.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;glslify&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.0.0&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;glslify&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;transform&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">[</span><span class="s2">&quot;glslify-hex&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nt">&quot;option-1&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;option-2&quot;</span><span class="p">:</span> <span class="mi">42</span>
      <span class="p">}]</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Note that this method is only available for local transforms.</p>
<p>You may also specify transforms via the CLI:</p>
<pre><code class="lang-bash">glslify -t <span class="s1">&apos;local-transform&apos;</span> -g <span class="s1">&apos;global-transform&apos;</span> -p <span class="s1">&apos;post-transform&apos;</span>
</code></pre>
<p>Or when using the browserify transform by including them as
options like so:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">glslify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glslify&apos;</span><span class="p">)</span>

<span class="nx">glslify</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&apos;/shader.glsl&apos;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">transform</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;glslify-hex&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="s2">&quot;option-1&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s2">&quot;option-2&quot;</span><span class="o">:</span> <span class="mi">42</span>
    <span class="p">}],</span>
    <span class="p">[</span><span class="s2">&quot;global-transform&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">global</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}],</span>
    <span class="p">[</span><span class="s2">&quot;post-transform&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">post</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}]</span>
  <span class="p">]</span>
<span class="p">})</span>
</code></pre>
<h2 id="migrating-from-glslify-1-to-glslify-2">Migrating from glslify@1 to glslify@2</h2>
<p>There are two important changes to note:</p>
<ul>
<li><a href="http://github.com/stackgl/gl-shader">gl-shader</a> is no longer bundled in with
glslify&apos;s browserify transform.</li>
<li>glslify now accepts files individually, rather than frag/vert pairings.</li>
</ul>
<p>The following:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">glslify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glslify&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">shader</span> <span class="o">=</span> <span class="nx">glslify</span><span class="p">({</span>
  <span class="nx">frag</span><span class="o">:</span> <span class="s1">&apos;./shader.frag&apos;</span><span class="p">,</span>
  <span class="nx">vert</span><span class="o">:</span> <span class="s1">&apos;./shader.vert&apos;</span>
<span class="p">})(</span><span class="nx">gl</span><span class="p">)</span>
</code></pre>
<p>Should now be created like so:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">glShader</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;gl-shader&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">glslify</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glslify&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">shader</span> <span class="o">=</span> <span class="nx">glShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span>
  <span class="nx">glslify</span><span class="p">(</span><span class="s1">&apos;./shader.vert&apos;</span><span class="p">),</span>
  <span class="nx">glslify</span><span class="p">(</span><span class="s1">&apos;./shader.frag&apos;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
<h2 id="module-api">Module API</h2>
<p>You can use glslify from Node using <code>glslify.bundle</code>. The operation is
performed asynchronously, but otherwise it shares the same API as
glslify&apos;s browserify transform.</p>
<h3 id="-glslify-bundle-file-opts-done-"><code>glslify.bundle(file, opts, done)</code></h3>
<p>Takes a <code>file</code> and calls <code>done(err, source, files)</code> with the finished shader
when complete. <code>files</code> is an array of all the files required from the
dependency tree, including the entry file.</p>
<p>Options include:</p>
<ul>
<li><code>inline</code>: if set to true, you can pass the GLSL source directly in
place of the <code>file</code> argument.</li>
<li><code>transform</code>: an array of transforms to apply to the shader.</li>
<li><code>basedir</code>: the directory from which to resolve modules from in your
first shader. Defaults to the first file&apos;s directory, or <code>process.cwd()</code>
if inline mode is enabled.</li>
</ul>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="http://mattdesl.svbtle.com/glslify">Modular and Versioned GLSL</a> by <a href="http://mattdesl.svbtle.com/">@mattdesl</a>.</li>
<li><a href="https://github.com/mattdesl/module-best-practices">Module Best Practices</a> by <a href="http://mattdesl.svbtle.com/">@mattdesl</a>.</li>
<li><a href="https://github.com/maxogden/art-of-node">Art of Node</a> by <a href="http://github.com/maxogden">@maxogden</a>.</li>
<li><a href="https://github.com/substack/browserify-handbook">Browserify Handbook</a> by <a href="http://substack.net">@substack</a>.</li>
<li>The upcoming <a href="http://www.crcpress.com/product/isbn/9781498716079">WebGL Insights</a> will include a chapter introducing glslify in detail.</li>
</ul>
<h2 id="contributing">Contributing</h2>
<p>See <a href="https://github.com/stackgl/contributing">stackgl/contributing</a> for details.</p>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/stackgl/glslify/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
