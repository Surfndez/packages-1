<h1 id="gl-vao">gl-vao</h1>
<p>WebGL vertex array object wrapper/polyfill</p>
<iframe scrolling="no" seamless="seamless" src="http://stack.gl/gl-vao/"></iframe><h2 id="example">Example</h2>
<p><a href="http://stack.gl/gl-vao/">Try out the demo in your browser</a></p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">shell</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-now&quot;</span><span class="p">)()</span>
<span class="kd">var</span> <span class="nx">createBuffer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-buffer&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createVAO</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-vao&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">glslify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;glslify&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">createShader</span> <span class="o">=</span> <span class="nx">glslify</span><span class="p">({</span>
  <span class="nx">vertex</span><span class="o">:</span> <span class="s2">&quot;\</span>
<span class="s2">    attribute vec2 position;\</span>
<span class="s2">    attribute vec3 color;\</span>
<span class="s2">    varying vec3 fragColor;\</span>
<span class="s2">    void main() {\</span>
<span class="s2">      gl_Position = vec4(position, 0, 1.0);\</span>
<span class="s2">      fragColor = color;\</span>
<span class="s2">    }&quot;</span><span class="p">,</span>
  <span class="nx">fragment</span><span class="o">:</span> <span class="s2">&quot;\</span>
<span class="s2">    precision highp float;\</span>
<span class="s2">    varying vec3 fragColor;\</span>
<span class="s2">    void main() {\</span>
<span class="s2">      gl_FragColor = vec4(fragColor, 1.0);\</span>
<span class="s2">    }&quot;</span><span class="p">,</span>
  <span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">vao</span><span class="p">,</span> <span class="nx">shader</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-init&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>

  <span class="c1">//Create shader object</span>
  <span class="nx">shader</span> <span class="o">=</span> <span class="nx">createShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">)</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">color</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1">//Create vertex array object</span>
  <span class="nx">vao</span> <span class="o">=</span> <span class="nx">createVAO</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">&quot;buffer&quot;</span><span class="o">:</span> <span class="nx">createBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span>
      <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="mi">2</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
  <span class="p">])</span>
<span class="p">})</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-render&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>

  <span class="c1">//Bind the shader</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>

  <span class="c1">//Bind vertex array object and draw it</span>
  <span class="nx">vao</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
  <span class="nx">vao</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

  <span class="c1">//Unbind vertex array when fini</span>
  <span class="nx">vao</span><span class="p">.</span><span class="nx">unbind</span><span class="p">()</span>
<span class="p">})</span>
</code></pre>
<p>Assuming everything worked, here is what it should look like:</p>
<p><img src="http://stack.gl/gl-vao/screenshot.png"></p>
<h2 id="install">Install</h2>
<p>Use <a href="https://npmjs.org/">npm</a>:</p>
<pre><code>npm install gl-vao
</code></pre><p>To compile demos in for your browser try <a href="https://github.com/substack/node-browserify">browserify</a> or <a href="https://github.com/chrisdickinson/beefy">beefy</a>.</p>
<h2 id="api">API</h2>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createVAO</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-vao&quot;</span><span class="p">)</span>
</code></pre>
<h3 id="-var-vao-createvao-gl-attributes-elements-elementstype-"><code>var vao = createVAO(gl, attributes[, elements][, elementsType])</code></h3>
<p>Creates a vertex array object</p>
<ul>
<li><code>gl</code> is the gl context in which the vertex array object is created</li>
<li><p><code>attributes</code> is an array of objects that give the attributes bound to particular locations starting at 0.  Each of these attributes is either an array-like object of length 4 or less representing a constant attribute value, or else it is an object with the following properties that correspond to the parameters passed to <a href="http://www.khronos.org/opengles/sdk/docs/man/xhtml/glVertexAttribPointer.xml"><code>gl.vertexAttribPointer</code></a></p>
<ul>
<li><code>buffer</code> a <a href="https://github.com/mikolalysenko/gl-buffer"><code>gl-buffer</code></a> object encoding a webgl buffer</li>
<li><code>size</code> the size of the attribute (default 4)</li>
<li><code>type</code> the type of the attribute (default <code>gl.FLOAT</code>)</li>
<li><code>normalized</code> a flag that checks whether the attribute should be normalized or not</li>
<li><code>stride</code> the stride of the attribute <strong>in bytes</strong> (default 0)</li>
<li><code>offset</code> offset to the start of the attribute in the buffer <strong>in bytes</strong> (default 0)</li>
</ul>
</li>
<li><p><code>elements</code> is a buffer created using <a href="https://github.com/mikolalysenko/gl-buffer"><code>gl-buffer</code></a> encoding the state of the vertex elements</p>
</li>
<li><p><code>elementsType</code> the type of data contained within the element buffer, if given. Defaults to <code>gl.UNSIGNED_SHORT</code>. Acceptable values are <code>gl.UNSIGNED_BYTE</code>, <code>gl.UNSIGNED_SHORT</code>. If the <code>OES_element_index_uint</code> extension is available and active, <code>gl.UNSIGNED_INT</code> may also be used.</p>
</li>
</ul>
<h3 id="-vao-bind-"><code>vao.bind()</code></h3>
<p>Binds the vertex array object to the active vertex state.</p>
<h3 id="-vao-unbind-"><code>vao.unbind()</code></h3>
<p>Unbinds the vertex array object.</p>
<p><strong>Note</strong> You should call this method before switching back to using vertex arrays and buffers as usual.  Failing to do so can cause the state of the vertex array object to become corrupted.  However, it is acceptable to skip the unbind step if another vertex array object is immediately bound.</p>
<h3 id="-vao-draw-mode-count-offset-"><code>vao.draw(mode, count[, offset])</code></h3>
<p>Draws the vertex array object.</p>
<ul>
<li><code>mode</code> is the mode to use when drawing the buffer, for example <code>gl.TRIANGLES</code>, <code>gl.LINES</code>, etc.</li>
<li><code>count</code> is the number of vertices to draw.</li>
<li><code>offset</code> is the offset to start drawing from.  Default <code>0</code></li>
</ul>
<h3 id="-vao-update-attributes-elements-elementstype-"><code>vao.update(attributes[, elements][, elementsType])</code></h3>
<p>Updates the contents of the vertex array object using the same syntax and conventions as the constructor.</p>
<h3 id="-vao-dispose-"><code>vao.dispose()</code></h3>
<p>Destroys the vertex array object and releases all of its resources.</p>
<h2 id="credits">Credits</h2>
<p>(c) 2013 Mikola Lysenko. MIT License</p>
