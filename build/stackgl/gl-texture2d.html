<h1 id="gl-texture2d"><a target="_blank" href="http://github.com/stackgl/gl-texture2d">gl-texture2d</a></h1>
<p>WebGL texture object wrapper</p>
<iframe scrolling="no" seamless="seamless" src="http://stack.gl/gl-texture2d/"></iframe><h1 id="example">Example</h1>
<p><a href="http://gl-modules.github.io/gl-texture2d/">Try it in your browser right now</a></p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">shell</span>         <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-now&quot;</span><span class="p">)()</span>
<span class="kd">var</span> <span class="nx">createShader</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-shader&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createTexture</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-texture2d&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">drawTriangle</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;a-big-triangle&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">baboon</span>        <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;baboon-image&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">glslify</span>       <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;glslify&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">createShader</span> <span class="o">=</span> <span class="nx">glslify</span><span class="p">({</span>
  <span class="nx">vertex</span><span class="o">:</span><span class="s2">&quot;\</span>
<span class="s2">    attribute vec2 position;\</span>
<span class="s2">    varying vec2 texCoord;\</span>
<span class="s2">    void main() {\</span>
<span class="s2">      gl_Position = vec4(position, 0, 1);\</span>
<span class="s2">      texCoord = vec2(0.0,1.0)+vec2(0.5,-0.5) * (position + 1.0);\</span>
<span class="s2">    }&quot;</span><span class="p">,</span> 
  <span class="nx">fragment</span><span class="o">:</span> <span class="s2">&quot;\</span>
<span class="s2">    precision highp float;\</span>
<span class="s2">    uniform sampler2D texture;\</span>
<span class="s2">    varying vec2 texCoord;\</span>
<span class="s2">    void main() {\</span>
<span class="s2">      gl_FragColor = texture2D(texture, texCoord);\</span>
<span class="s2">    }&quot;</span><span class="p">,</span>
  <span class="nx">inline</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">shader</span><span class="p">,</span> <span class="nx">texture</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-init&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>

  <span class="c1">//Create texture</span>
  <span class="nx">texture</span> <span class="o">=</span> <span class="nx">createTexture</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="nx">baboon</span><span class="p">)</span>

  <span class="c1">//Create shader</span>
  <span class="nx">shader</span> <span class="o">=</span> <span class="nx">createShader</span><span class="p">(</span><span class="nx">gl</span><span class="p">)</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">})</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-render&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//Draw it</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
  <span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">texture</span> <span class="o">=</span> <span class="nx">texture</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
  <span class="nx">drawTriangle</span><span class="p">(</span><span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span><span class="p">)</span>
<span class="p">})</span>
</code></pre>
<p>Here is what it should look like:</p>
<p><img src="https://raw.github.com/mikolalysenko/gl-texture2d/master/screenshot.png"></p>
<h1 id="install">Install</h1>
<pre><code>npm install gl-texture2d
</code></pre><h1 id="api">API</h1>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createTexture</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-texture2d&quot;</span><span class="p">)</span>
</code></pre>
<h2 id="constructor">Constructor</h2>
<p>There are three basic usage patterns for <code>createTexture</code>:</p>
<h3 id="-var-tex-createtexture-gl-shape-format-type-"><code>var tex = createTexture(gl, shape[, format, type])</code></h3>
<p>Creates an unitialized texture with the given dimensions and format</p>
<ul>
<li><code>shape</code> is a length 2 array representing the <code>[width, height]</code> of the texture</li>
<li><code>format</code> (optional) is the format of the texture (default <code>gl.RGBA</code>)</li>
<li><code>type</code> is the type of texture (default <code>gl.UNSIGNED_BYTE</code>)</li>
</ul>
<h3 id="-var-tex-createtexture-gl-domelement-format-type-"><code>var tex = createTexture(gl, domElement[, format, type])</code></h3>
<p>Creates a texture from the given data source.  Where <code>domElement</code> is one of the following items:</p>
<ul>
<li>An <code>ImageData</code> object</li>
<li>An <code>HTMLCanvas</code> object</li>
<li>An <code>HTMLImage</code> object</li>
<li>An <code>HTMLVideo</code> object</li>
</ul>
<p>And <code>format</code> is an OpenGL data format or defaults to <code>gl.RGBA</code> and <code>type</code> is the storage type which defaults to <code>gl.UNSIGNED_BYTE</code></p>
<h3 id="-var-tex-createtexture-gl-array-"><code>var tex = createTexture(gl, array)</code></h3>
<p>Creates a texture from an <a href="https://github.com/mikolalysenko/ndarray">ndarray</a>.  The rules for selecting the format and type depend on the shape of the ndarray.  The type of the texture is inferred according to the following rules.  Let:</p>
<ul>
<li><code>dtype = ndarray.dtype(array)</code></li>
<li><code>shape = array.shape</code></li>
</ul>
<p>Then the rules for <code>type</code> and <code>format</code> are defined according to the following table:</p>
<table>
<thead>
<tr>
<th><code>dtype</code></th>
<th style="text-align:center"><code>shape</code></th>
<th style="text-align:center"><code>format</code></th>
<th style="text-align:center"><code>type</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float*</code></td>
<td style="text-align:center">[w,h]</td>
<td style="text-align:center">LUMINANCE</td>
<td style="text-align:center">FLOAT</td>
</tr>
<tr>
<td><code>float*</code></td>
<td style="text-align:center">[w,h,1]</td>
<td style="text-align:center">ALPHA</td>
<td style="text-align:center">FLOAT</td>
</tr>
<tr>
<td><code>float*</code></td>
<td style="text-align:center">[w,h,2]</td>
<td style="text-align:center">LUMINANCE_ALPHA</td>
<td style="text-align:center">FLOAT</td>
</tr>
<tr>
<td><code>float*</code></td>
<td style="text-align:center">[w,h,3]</td>
<td style="text-align:center">RGB</td>
<td style="text-align:center">FLOAT</td>
</tr>
<tr>
<td><code>float*</code></td>
<td style="text-align:center">[w,h,4]</td>
<td style="text-align:center">RGBA</td>
<td style="text-align:center">FLOAT</td>
</tr>
<tr>
<td><code>(u)int*</code></td>
<td style="text-align:center">[w,h]</td>
<td style="text-align:center">LUMINANCE</td>
<td style="text-align:center">UNSIGNED_BYTE</td>
</tr>
<tr>
<td><code>(u)int*</code></td>
<td style="text-align:center">[w,h,1]</td>
<td style="text-align:center">ALPHA</td>
<td style="text-align:center">UNSIGNED_BYTE</td>
</tr>
<tr>
<td><code>(u)int*</code></td>
<td style="text-align:center">[w,h,2]</td>
<td style="text-align:center">LUMINANCE_ALPHA</td>
<td style="text-align:center">UNSIGNED_BYTE</td>
</tr>
<tr>
<td><code>(u)int*</code></td>
<td style="text-align:center">[w,h,3]</td>
<td style="text-align:center">RGB</td>
<td style="text-align:center">UNSIGNED_BYTE</td>
</tr>
<tr>
<td><code>(u)int*</code></td>
<td style="text-align:center">[w,h,4]</td>
<td style="text-align:center">RGBA</td>
<td style="text-align:center">UNSIGNED_BYTE</td>
</tr>
</tbody>
</table>
<p>Other combinations of shape and dtype are invalid and throw an error.</p>
<h2 id="texture-methods">Texture Methods</h2>
<h3 id="-tex-bind-texunit-"><code>tex.bind([texUnit])</code></h3>
<p>Binds the texture for use.  Basically a short cut for:</p>
<pre><code class="lang-javascript"><span class="nx">gl</span><span class="p">.</span><span class="nx">activeTexture</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TEXTURE0</span> <span class="o">+</span> <span class="nx">texUnit</span><span class="p">)</span>
<span class="nx">gl</span><span class="p">.</span><span class="nx">bindTexture</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">TEXTURE_2D</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">)</span>
</code></pre>
<p>If <code>texUnit</code> is not specified then the active texture is not changed.</p>
<p><strong>Returns</strong> The texture unit the texture is bound to.</p>
<h3 id="-tex-dispose-">`tex.dispose()``</h3>
<p>Destroys the texture object and releases all of its resources.  Under the hood this is equivalent to:</p>
<pre><code class="lang-javascript"><span class="nx">gl</span><span class="p">.</span><span class="nx">deleteTexture</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handle</span><span class="p">)</span>
</code></pre>
<h3 id="-tex-setpixels-data-offset-miplevel-"><code>tex.setPixels(data[, offset, mipLevel])</code></h3>
<p>Unpacks <code>data</code> into a subregion of the texture.  As before in the constructor <code>data</code> can be either an <code>ndarray</code>, <code>HTMLCanvas</code>, <code>HTMLImage</code> or <code>HTMLVideo</code> object.  If <code>data</code> is an ndarray it must have a compatible format with the initial array layout.</p>
<ul>
<li><code>offset</code> is a length 2 array representing the offset into which the pixels will be written in <code>[x,y]</code>.  (Default: <code>[0,0]</code>)</li>
<li><code>mipLevel</code> is the mip level to write to. (Default <code>0</code>)</li>
</ul>
<p>If <code>data</code> is an <code>ndarray</code> the same rules as in the constructor are followed for converting the type of the buffer.</p>
<h3 id="-tex-generatemipmap-"><code>tex.generateMipmap()</code></h3>
<p>Generates mipmaps for the texture.  This will fail if the texture dimensions are not a power of two.</p>
<h2 id="texture-properties">Texture Properties</h2>
<h4 id="-tex-shape-"><code>tex.shape</code></h4>
<p>An array representing the dimensions of the texture in <code>[width, height]</code>.  Writing to this value will resize the texture and invalidate its contents.  For example, to resize the texture <code>tex</code> to the shape <code>[newWidth, newHeight]</code> you can do:</p>
<pre><code class="lang-javascript"><span class="nx">tex</span><span class="p">.</span><span class="nx">shape</span> <span class="o">=</span> <span class="p">[</span><span class="nx">newWidth</span><span class="p">,</span> <span class="nx">newHeight</span><span class="p">]</span>
</code></pre>
<h4 id="-tex-wrap-"><code>tex.wrap</code></h4>
<p>Texture wrap around behavior for x/y of the texture.  Used to set/get <code>[gl.TEXTURE_WRAP_T, gl.TEXTURE_WRAP_S]</code>.  Defaults to <code>[gl.CLAMP_TO_EDGE, gl.CLAMP_TO_EDGE]</code>.  To update this value, write to it with a vector. For example,</p>
<pre><code class="lang-javascript"><span class="nx">tex</span><span class="p">.</span><span class="nx">wrap</span> <span class="o">=</span> <span class="p">[</span><span class="nx">gl</span><span class="p">.</span><span class="nx">MIRRORED_REPEAT</span><span class="p">,</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">REPEAT</span><span class="p">]</span>
</code></pre>
<p>Or you can update it with a single value to set the wrap mode for both axes:</p>
<pre><code class="lang-javascript"><span class="nx">tex</span><span class="p">.</span><span class="nx">wrap</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">REPEAT</span>
</code></pre>
<h4 id="-tex-magfilter-"><code>tex.magFilter</code></h4>
<p>Magnification filter.  Used to set/get <code>gl.TEXTURE_MAG_FILTER</code>. Defaults to <code>gl.NEAREST</code></p>
<h4 id="-tex-minfilter-"><code>tex.minFilter</code></h4>
<p>Minification filter. Used to set/get <code>gl.TEXTURE_MIN_FILTER</code>. Defaults to <code>gl.NEAREST</code></p>
<h4 id="-tex-mipsamples-"><code>tex.mipSamples</code></h4>
<p>The number of anisotropic filtering samples to use.  This requires <code>EXT_texture_filter_anisotropic</code> to have any effect.  High values will improve mipmap quality, but decrease performance.</p>
<h2 id="internals">Internals</h2>
<h4 id="-tex-gl-"><code>tex.gl</code></h4>
<p>A reference to the WebGL context of the texture.</p>
<h4 id="-tex-handle-"><code>tex.handle</code></h4>
<p>A handle to the underlying texture object.</p>
<h4 id="-tex-format-"><code>tex.format</code></h4>
<p>The internal format of the texture.</p>
<h4 id="-tex-type-"><code>tex.type</code></h4>
<p>The internal data type of the texture.</p>
<h1 id="credits">Credits</h1>
<p>(c) 2013-2014 Mikola Lysenko. MIT License</p>
