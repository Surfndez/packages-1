<h1 id="gl-geometry-experimental-http-badges-github-io-stability-badges-dist-experimental-svg-http-github-com-badges-stability-badges-"><a target="_blank" href="http://github.com/hughsk/gl-geometry">gl-geometry <a href="http://github.com/badges/stability-badges"></a></a></h1>
<p>A flexible wrapper for <a href="http://github.com/mikolalysenko/gl-vao">gl-vao</a>
and <a href="http://github.com/mikolalysenko/gl-buffer">gl-buffer</a> that you can use to
set up renderable WebGL geometries from a variety of different formats.</p>
<h2 id="usage">Usage</h2>
<p><a href="https://nodei.co/npm/gl-geometry/"></a></p>
<h3 id="geom-creategeometry-gl-">geom = createGeometry(gl)</h3>
<p>Creates a new geometry attached to the WebGL canvas context <code>gl</code>.</p>
<h3 id="geom-attr-name-values-opt-">geom.attr(name, values[, opt])</h3>
<p>Define a new attribute value, for example using a simplicial complex:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createGeometry</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;gl-geometry&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">bunny</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;bunny&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">geom</span> <span class="o">=</span> <span class="nx">createGeometry</span><span class="p">(</span><span class="nx">gl</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&apos;positions&apos;</span><span class="p">,</span> <span class="nx">bunny</span><span class="p">)</span>
</code></pre>
<p>The following vertex formats are supported and will be normalized:</p>
<ul>
<li><p>Arrays of arrays, e.g. <code>[[0, 0, 0], [1, 0, 0], [1, 1, 0]]</code>.</p>
</li>
<li><p>Flat arrays, e.g. <code>[0, 0, 0, 1, 0, 0, 1, 1, 0]</code>.</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays">Typed arrays</a>,
preferably a <code>Float32Array</code>.</p>
</li>
<li><p>1-dimensional <a href="http://github.com/mikolalysenko/ndarray">ndarrays</a>.</p>
</li>
<li><p><a href="https://github.com/mikolalysenko/simplicial-complex">simplicial complexes</a>,
i.e. an object with a <code>positions</code> array and a <code>cells</code> array. The former is
a list of unique vertices in the mesh (if you&apos;ve used three.js, think
<code>THREE.Vector3</code>), and the latter is an index mapping these vertices to faces
(<code>THREE.Face3</code>) in the mesh. It looks something like this:</p>
<pre><code class="lang-json"><span class="p">{</span>
  <span class="nt">&quot;positions&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
  <span class="p">],</span>
  <span class="nt">&quot;cells&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>
</li>
</ul>
<p>You can specify <code>opt.size</code> for the vertex size, defaults to 3.</p>
<h3 id="geom-faces-values-opt-">geom.faces(values[, opt])</h3>
<p>Pass a simplicial complex&apos;s <code>cells</code> property here in any of the above formats
to use it as your index when drawing the geometry. For example:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createGeometry</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;gl-geometry&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">bunny</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;bunny&apos;</span><span class="p">)</span>

<span class="nx">bunny</span><span class="p">.</span><span class="nx">normals</span> <span class="o">=</span> <span class="nx">normals</span><span class="p">.</span><span class="nx">vertexNormals</span><span class="p">(</span>
    <span class="nx">bunny</span><span class="p">.</span><span class="nx">cells</span>
  <span class="p">,</span> <span class="nx">bunny</span><span class="p">.</span><span class="nx">positions</span>
<span class="p">)</span>

<span class="kd">var</span> <span class="nx">geom</span> <span class="o">=</span> <span class="nx">createGeometry</span><span class="p">(</span><span class="nx">gl</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&apos;positions&apos;</span><span class="p">,</span> <span class="nx">bunny</span><span class="p">.</span><span class="nx">positions</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&apos;normals&apos;</span><span class="p">,</span> <span class="nx">bunny</span><span class="p">.</span><span class="nx">normals</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">faces</span><span class="p">(</span><span class="nx">bunny</span><span class="p">.</span><span class="nx">cells</span><span class="p">)</span>
</code></pre>
<p>You can specify <code>opt.size</code> for the cell size, defaults to 3.</p>
<h3 id="geom-bind-shader-">geom.bind([shader])</h3>
<p>Binds the underlying <a href="https://github.com/gl-modules/gl-vao">VAO</a> &#x2013; this must
be called before calling <code>geom.draw</code>. Optionally, you can pass in a
<a href="http://github.com/gl-modules/gl-shader">gl-shader</a> or
<a href="http://github.com/chrisdickinson/glslify">glslify</a> shader instance to
automatically set up your attribute locations for you.</p>
<h3 id="geom-draw-mode-start-stop-">geom.draw(mode, start, stop)</h3>
<p>Draws the geometry to the screen using the currently bound shader.</p>
<p>Optionally, you can pass in the drawing mode, which should be one of the
following:</p>
<ul>
<li><code>gl.POINTS</code></li>
<li><code>gl.LINES</code></li>
<li><code>gl.LINE_STRIP</code></li>
<li><code>gl.LINE_LOOP</code></li>
<li><code>gl.TRIANGLES</code></li>
<li><code>gl.TRIANGLE_STRIP</code></li>
<li><code>gl.TRIANGLE_FAN</code></li>
</ul>
<p>The default value is <code>gl.TRIANGLES</code>. You&apos;re also able to pass in a <code>start</code> and
<code>stop</code> range for the points you want to render, just the same as you would
with <code>gl.drawArrays</code> or <code>gl.drawElements</code>.</p>
<h3 id="geom-unbind-">geom.unbind()</h3>
<p>Unbinds the underlying VAO. This <em>must</em> be done when you&apos;re finished drawing,
unless you&apos;re binding to another gl-geometry or gl-vao instance.</p>
<h3 id="geom-dispose-">geom.dispose()</h3>
<p>Disposes the underlying element and array buffers, as well as the VAO.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="https://www.khronos.org/registry/webgl/specs/1.0/#5.13">ArrayBuffer and Typed Arrays</a></li>
<li><a href="https://www.khronos.org/registry/webgl/specs/1.0/#5.14">The WebGL Context</a></li>
<li><a href="http://github.com/mikolalysenko/simplicial-complex">simplicial-complex</a></li>
<li><a href="http://github.com/mikolalysenko/ndarray">ndarray</a></li>
<li><a href="http://github.com/mikolalysenko/gl-shader">gl-shader</a></li>
<li><a href="http://github.com/mikolalysenko/gl-buffer">gl-buffer</a></li>
<li><a href="http://github.com/mikolalysenko/gl-vao">gl-vao</a></li>
</ul>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/hughsk/is-typedarray/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
