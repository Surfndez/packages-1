<h1 id="glsl-testify-experimental-http-badges-github-io-stability-badges-dist-experimental-svg-http-github-com-badges-stability-badges-">glsl-testify <a href="http://github.com/badges/stability-badges"></a></h1>
<p><a href="https://nodei.co/npm/glsl-testify/"></a></p>
<p>Test your GLSL shaders using GLSL!</p>
<p>glsl-testify allows you to write tests inside your GLSL shaders, which can then be
easily executed using the included CLI tool or manually run using the module
API.</p>
<h2 id="writing-a-test">Writing a Test</h2>
<p>To create a test, simply define a function in your shader that begins with <code>test</code>,
and returns a <code>bool</code>, e.g.:</p>
<pre><code class="lang-glsl"><span class="k">bool</span> <span class="n">test_will_pass</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>If the function returns <code>true</code>, then the test is considered passed. glsl-testify
works by generating a shader for each test, and then checking the result of
rendering to a single pixel: a pass is white, and a fail is black.</p>
<p>Using the module API, you&apos;ll get back this collection of shaders directly, meaning
that you get the flexibility to work with said shaders however you please.</p>
<h2 id="cli-usage">CLI Usage</h2>
<pre><code>Usage: glsl-testify [file]

Takes a testable GLSL shader as input, spawning a temporary browser
window and runs the tests without any uniforms. Outputs TAP, so
you can pass this on to other testing tools to deal with the results.
</code></pre><p>For example:</p>
<pre><code class="lang-bash"><span class="c"># Install your tools globally</span>
npm install -g glsl-testify tap-spec
<span class="c"># Pipe your shader through glsl-testify to tap-spec</span>
<span class="c"># for nice test output!</span>
cat example.glsl <span class="p">|</span> glsl-testify <span class="p">|</span> tap-spec
</code></pre>
<p>While the current tool opens a browser window to run the test, hopefully
in the future we&apos;ll be able to get WebGL running headlessly in node
for easier CI.</p>
<p><img src="http://imgur.com/llQPhBp.png" alt="example"></p>
<h2 id="module-usage">Module Usage</h2>
<h3 id="stream-testify-done-err-tests-">stream = testify(done(err, tests))</h3>
<p>Returns a stream that expects input from
<a href="http://github.com/chrisdickinson/glsl-parser">glsl-parser</a>, calling
<code>done</code> with the resulting test shaders when complete.</p>
<p>For example:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">tokenizer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glsl-tokenizer&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">testify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glsl-testify&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;glsl-parser&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;fs&apos;</span><span class="p">)</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">&apos;example.glsl&apos;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">tokenizer</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">parser</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">testify</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">testShaders</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">testShaders</span><span class="p">.</span><span class="nx">test_pass</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">testShaders</span><span class="p">.</span><span class="nx">test_fail</span><span class="p">)</span>
  <span class="p">}))</span>
</code></pre>
<p>Each test is simply a fragment shader which will draw white if
the test has passed or black if it fails. You can run these using
your own tools, for example to add uniform/attributes as input.</p>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/hughsk/glsl-testify/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
