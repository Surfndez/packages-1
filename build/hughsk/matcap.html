<h1 id="matcap-flattr-this-https-api-flattr-com-button-flattr-badge-large-png-https-flattr-com-submit-auto-user_id-hughskennedy-url-http-github-com-hughsk-matcap-title-matcap-description-hughsk-matcap-20on-20github-language-en_gb-tags-flattr-github-javascript-category-software-experimental-http-hughsk-github-io-stability-badges-dist-experimental-svg-http-github-com-hughsk-stability-badges-img-src-http-imgur-com-2kpqkaj-png-align-right-"><a target="_blank" href="http://github.com/hughsk/matcap">matcap <a href="https://flattr.com/submit/auto?user_id=hughskennedy&amp;url=http://github.com/hughsk/matcap&amp;title=matcap&amp;description=hughsk/matcap%20on%20GitHub&amp;language=en_GB&amp;tags=flattr,github,javascript&amp;category=software"></a><a href="http://github.com/hughsk/stability-badges"></a> </a></h1>
<p>GLSL shaders for calculating/rendering Spherical Environment Maps, or &quot;matcaps&quot;.</p>
<p>For more information, check out
<a href="http://www.clicktorelease.com/blog/creating-spherical-environment-mapping-shader">Creating a Spherical Reflection/Environment Mapping shader</a>,
which was used as a reference when writing this module and the demo.</p>
<p>Most of the images in the demo were sourced from
<a href="http://www.clicktorelease.com/code/spherical-normal-mapping/">this demo</a>,
though a couple I made myself.</p>
<iframe scrolling="no" seamless="seamless" src="http://hughsk.io/matcap/"></iframe><h3 id="-view-demo-http-hughsk-github-io-matcap-"><a href="http://hughsk.github.io/matcap/">view demo</a></h3>
<h2 id="usage">Usage</h2>
<p><a href="https://nodei.co/npm/matcap"></a></p>
<h3 id="with-glslify">With glslify</h3>
<p>You can import the module using
<a href="http://github.com/chrisdickinson/glslify">glslify</a> to get the bare function
responsible for generating the texture coordinate to look up.</p>
<p>This function takes two arguments:</p>
<ul>
<li><code>vec3 eye</code>: the camera&apos;s current position.</li>
<li><code>vec3 normal</code>: the surface&apos;s normal vector.</li>
</ul>
<p>Returning a <code>vec2</code> you can use on your <code>sampler2D</code>.</p>
<pre><code class="lang-glsl"><span class="cp">#pragma glslify: matcap = require(matcap)</span>

<span class="k">uniform</span> <span class="k">sampler2D</span> <span class="n">texture</span><span class="p">;</span> <span class="c1">// the matcap texture you want to use</span>
<span class="k">uniform</span> <span class="k">vec3</span> <span class="n">eyeVector</span><span class="p">;</span>
<span class="k">varying</span> <span class="k">vec3</span> <span class="n">normalVector</span><span class="p">;</span>

<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">vec2</span> <span class="n">uv</span> <span class="o">=</span> <span class="n">matcap</span><span class="p">(</span><span class="n">eyeVector</span><span class="p">,</span> <span class="n">normalVector</span><span class="p">);</span>

  <span class="n">gl_FragColor</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="n">texture2D</span><span class="p">(</span>
    <span class="n">texture</span><span class="p">,</span> <span class="n">uv</span>
  <span class="p">).</span><span class="n">rgb</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
<h3 id="with-browserify">With browserify</h3>
<p>If you&apos;re looking to get started a little more quickly, you can require matcap
as a module from <a href="http://github.com/substack/node-browserify">browserify</a>.</p>
<p>The required function simply takes the current WebGL context, and returns a
a GLSL program wrapped up in
<a href="http://github.com/gl-modules/gl-shader-core">gl-shader-core</a>.</p>
<p>You&apos;ll still need to take care of its uniforms and attributes though:</p>
<pre><code class="lang-javascript"><span class="nx">shader</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">aPosition</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">aNormal</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">uTexture</span> <span class="o">=</span> <span class="nx">textureIndex</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">uEye</span> <span class="o">=</span> <span class="nx">eyeVector</span>

<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">mView</span> <span class="o">=</span> <span class="nx">viewMatrix</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">mModel</span> <span class="o">=</span> <span class="nx">modelMatrix</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">mNormal</span> <span class="o">=</span> <span class="nx">normalMatrix</span>
<span class="nx">shader</span><span class="p">.</span><span class="nx">uniforms</span><span class="p">.</span><span class="nx">mProjection</span> <span class="o">=</span> <span class="nx">projectionMatrix</span>
</code></pre>
<p>If you&apos;re looking for a full example, check out the demo!</p>
<h2 id="license">License</h2>
<p>MIT. See <a href="http://github.com/hughsk/matcap/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
