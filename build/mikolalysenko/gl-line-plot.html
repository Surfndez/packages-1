<h1 id="gl-line-plot">gl-line-plot</h1>
<p>A 3D line plot for WebGL</p>
<iframe scrolling="no" seamless="seamless" src="http://mikolalysenko.github.io/gl-line-plot/"></iframe><h1 id="example">Example</h1>
<p><a href="http://mikolalysenko.github.io/gl-line-plot">Try it out in your browser</a></p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">shell</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-now&quot;</span><span class="p">)({</span> <span class="nx">clearColor</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">})</span>
<span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;game-shell-orbit-camera&quot;</span><span class="p">)(</span><span class="nx">shell</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createSelect</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-select&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createAxes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-axes&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createSpikes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-spikes&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createLines</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-lines&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">mat4</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-matrix&quot;</span><span class="p">).</span><span class="nx">mat4</span>

<span class="c1">//State variables</span>
<span class="kd">var</span>  <span class="nx">axes</span><span class="p">,</span> <span class="nx">lines</span><span class="p">,</span> <span class="nx">select</span><span class="p">,</span> <span class="nx">spikes</span>

<span class="kd">var</span> <span class="nx">pickPoint</span> <span class="o">=</span> <span class="kc">null</span>

<span class="c1">//Set up camera</span>
<span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">(</span>
  <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
  <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
  <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-init&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>

  <span class="c1">//Create the line plot</span>
  <span class="kd">var</span> <span class="nx">polyline</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">theta</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span>
    <span class="nx">polyline</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="nx">theta</span><span class="p">),</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="nx">theta</span><span class="p">),</span>
        <span class="p">(</span><span class="nx">i</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>
      <span class="p">])</span>
  <span class="p">}</span>
  <span class="nx">lines</span> <span class="o">=</span> <span class="nx">createLines</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">polyline</span><span class="p">,</span>
    <span class="nx">color</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
  <span class="p">})</span>

  <span class="c1">//Create axes object</span>
  <span class="nx">axes</span> <span class="o">=</span> <span class="nx">createAxes</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">bounds</span><span class="o">:</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
  <span class="p">})</span>

  <span class="c1">//Create selection buffer</span>
  <span class="nx">select</span> <span class="o">=</span> <span class="nx">createSelect</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">[</span><span class="nx">shell</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">width</span><span class="p">])</span>

  <span class="c1">//Create axes spikes</span>
  <span class="nx">spikes</span> <span class="o">=</span> <span class="nx">createSpikes</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="p">{</span><span class="nx">bounds</span><span class="o">:</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]})</span>
<span class="p">})</span>

<span class="kd">function</span> <span class="nx">drawPick</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">select</span><span class="p">.</span><span class="nx">shape</span> <span class="o">=</span> <span class="p">[</span><span class="nx">shell</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">width</span><span class="p">]</span>
  <span class="nx">select</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span><span class="nx">shell</span><span class="p">.</span><span class="nx">mouse</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">mouse</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
  <span class="nx">lines</span><span class="p">.</span><span class="nx">drawPick</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span>
  <span class="kd">var</span> <span class="nx">selected</span> <span class="o">=</span> <span class="nx">select</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
  <span class="nx">pickPoint</span> <span class="o">=</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">pick</span><span class="p">(</span><span class="nx">selected</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-render&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">DEPTH_TEST</span><span class="p">)</span>

  <span class="c1">//Compute camera parameters</span>
  <span class="kd">var</span> <span class="nx">cameraParameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">view</span><span class="o">:</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">view</span><span class="p">(),</span>
    <span class="nx">projection</span><span class="o">:</span> <span class="nx">mat4</span><span class="p">.</span><span class="nx">perspective</span><span class="p">(</span>
        <span class="nx">mat4</span><span class="p">.</span><span class="nx">create</span><span class="p">(),</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">4.0</span><span class="p">,</span>
        <span class="nx">shell</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="nx">shell</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">,</span>
        <span class="mf">1000.0</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">//Compute user selection</span>
  <span class="nx">drawPick</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span>

  <span class="c1">//Draw the axes + lines</span>
  <span class="nx">axes</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span>
  <span class="nx">lines</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span>

  <span class="c1">//If a point is picked, draw it</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">pickPoint</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">spikes</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">pickPoint</span><span class="p">.</span><span class="nx">position</span>
    <span class="nx">spikes</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">cameraParameters</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
<h1 id="install">Install</h1>
<pre><code>npm install gl-line-plot
</code></pre><h1 id="api">API</h1>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createLinePlot</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-line-plot&quot;</span><span class="p">)</span>
</code></pre>
<h2 id="constructor">Constructor</h2>
<h4 id="-var-plot-createlineplot-gl-options-"><code>var plot = createLinePlot(gl, options)</code></h4>
<h2 id="methods">Methods</h2>
<h3 id="basic-drawing">Basic Drawing</h3>
<h4 id="-plot-draw-camera-"><code>plot.draw(camera)</code></h4>
<p>Draws the line plot with the given camera parameters</p>
<ul>
<li><code>camera</code> is an object with the model, view and projection matrices of the plot as properties.</li>
</ul>
<h4 id="-plot-update-options-"><code>plot.update(options)</code></h4>
<p>Updates the plot.  This takes the following parameters:</p>
<ul>
<li><code>options.position</code> An array of position values for the points on the curve</li>
<li><code>options.color</code> An array of color values (or a singular color) for the curve</li>
<li><code>options.pickId</code> The selection ID for the line plot</li>
<li><code>options.lineWidth</code> The width of the line</li>
<li><code>options.dashes</code> An array of dash patterns representing the dash pattern.  For example, <code>[0.5,0.5,0.5]</code></li>
<li><code>options.dashScale</code> The number of times to repeat the dash pattern</li>
</ul>
<h4 id="-plot-dispose-"><code>plot.dispose()</code></h4>
<p>Destroys the plot and releases all associated resources</p>
<h3 id="picking">Picking</h3>
<h4 id="-plot-drawpick-camera-"><code>plot.drawPick(camera)</code></h4>
<p>Draws the line plot for picking purposes from the given camera</p>
<h4 id="-plot-pick-selection-"><code>plot.pick(selection)</code></h4>
<p>Returns selection information from the given user selection data.</p>
<ul>
<li><code>selection</code> is the output from <code>gl-select</code></li>
</ul>
<p><strong>Returns</strong> An object with the following properties:</p>
<ul>
<li><code>arcLength</code> the arc length parameter of the selection</li>
<li><code>position</code> the position of the vertex at the selected point</li>
<li><code>index</code> the index of the closest data point</li>
</ul>
<h2 id="properties">Properties</h2>
<h4 id="-plot-bounds-"><code>plot.bounds</code></h4>
<p>Gives the bounds on the line plot in data coordinates.</p>
<h4 id="-plot-clipbounds-"><code>plot.clipBounds</code></h4>
<p>Sets a clipping bound on the line plot</p>
<h1 id="credits">Credits</h1>
<p>(c) 2014 Mikola Lysenko. MIT License</p>
