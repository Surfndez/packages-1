<h1 id="vectorize-text"><a target="_blank" href="http://github.com/mikolalysenko/vectorize-text">vectorize-text</a></h1>
<p>Convert a string of text into a vectorized geometric representation.  Works in both node.js and <a href="http://browserify.org/">browserify</a>.</p>
<h1 id="example">Example</h1>
<p>This module is capable of outputting geometry in several formats.</p>
<h3 id="planar-graphs">Planar graphs</h3>
<p>The default (and fastest) output from the module is a planar graph:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">vectorizeText</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;vectorize-text&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">graph</span> <span class="o">=</span> <span class="nx">vectorizeText</span><span class="p">(</span><span class="s2">&quot;Hello world! &#x4F60;&#x597D;&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="nx">textBaseline</span><span class="o">:</span> <span class="s2">&quot;hanging&quot;</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&apos;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  width=&quot;500&quot;  height=&quot;80&quot; &gt;&apos;</span><span class="p">]</span>
<span class="nx">graph</span><span class="p">.</span><span class="nx">edges</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p0</span> <span class="o">=</span> <span class="nx">graph</span><span class="p">.</span><span class="nx">positions</span><span class="p">[</span><span class="nx">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
  <span class="kd">var</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nx">graph</span><span class="p">.</span><span class="nx">positions</span><span class="p">[</span><span class="nx">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
  <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&lt;line x1=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos;&quot; y1=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
    <span class="s1">&apos;&quot; x2=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos;&quot; y2=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
    <span class="s1">&apos;&quot; stroke-width=&quot;1&quot; stroke=&quot;black&quot; /&gt;&apos;</span><span class="p">)</span>
<span class="p">})</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&lt;/svg&gt;&quot;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">svg</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
</code></pre>
<p>Output:</p>
<p><img src="https://mikolalysenko.github.io/vectorize-text/example/hello-graph.svg"></p>
<h3 id="polygons">Polygons</h3>
<p>You can also configure the module to emit polygons instead:</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">vectorizeText</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;vectorize-text&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">polygons</span> <span class="o">=</span> <span class="nx">vectorizeText</span><span class="p">(</span><span class="s2">&quot;Hello world! &#x4F60;&#x597D;&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">polygons</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="nx">textBaseline</span><span class="o">:</span> <span class="s2">&quot;hanging&quot;</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  width=&quot;500&quot;  height=&quot;80&quot; &gt;&apos;</span><span class="p">)</span>
<span class="nx">polygons</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">loops</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&lt;path d=&quot;&apos;</span><span class="p">)</span>
  <span class="nx">loops</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;M &apos;</span> <span class="o">+</span> <span class="nx">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos; &apos;</span> <span class="o">+</span> <span class="nx">start</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">loop</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
      <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;L &apos;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos; &apos;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;L &apos;</span> <span class="o">+</span> <span class="nx">start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos; &apos;</span> <span class="o">+</span> <span class="nx">start</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  <span class="p">})</span>
  <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&quot; fill-rule=&quot;even-odd&quot; stroke-width=&quot;1&quot; fill=&quot;red&quot;&gt;&lt;/path&gt;&apos;</span><span class="p">)</span>
<span class="p">})</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&lt;/svg&gt;&apos;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span>
</code></pre>
<p>Output:</p>
<p><img src="https://mikolalysenko.github.io/vectorize-text/example/hello-polygon.svg"></p>
<h3 id="triangulations">Triangulations</h3>
<p>Finally, the module can output a triangulation (which is compatible with WebGL for example):</p>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">vectorizeText</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;vectorize-text&quot;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">complex</span> <span class="o">=</span> <span class="nx">vectorizeText</span><span class="p">(</span><span class="s2">&quot;Hello world! &#x4F60;&#x597D;&quot;</span><span class="p">,</span> <span class="p">{</span> 
  <span class="nx">triangles</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="nx">textBaseline</span><span class="o">:</span> <span class="s2">&quot;hanging&quot;</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&apos;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  width=&quot;500&quot;  height=&quot;80&quot; &gt;&apos;</span><span class="p">]</span>
<span class="nx">complex</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p0</span> <span class="o">=</span> <span class="nx">complex</span><span class="p">.</span><span class="nx">positions</span><span class="p">[</span><span class="nx">c</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span>
    <span class="kd">var</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nx">complex</span><span class="p">.</span><span class="nx">positions</span><span class="p">[</span><span class="nx">c</span><span class="p">[(</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">]]</span>
    <span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&apos;&lt;line x1=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos;&quot; y1=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
      <span class="s1">&apos;&quot; x2=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&apos;&quot; y2=&quot;&apos;</span> <span class="o">+</span> <span class="nx">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
      <span class="s1">&apos;&quot; stroke-width=&quot;1&quot; stroke=&quot;black&quot; /&gt;&apos;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="nx">svg</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;&lt;/svg&gt;&quot;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span>
</code></pre>
<p>Output:</p>
<p><img src="https://mikolalysenko.github.io/vectorize-text/example/hello-triangles.svg"></p>
<h1 id="install">Install</h1>
<pre><code class="lang-sh">npm install vectorize-text
</code></pre>
<h1 id="api">API</h1>
<h4 id="-require-vectorize-text-string-options-"><code>require(&quot;vectorize-text&quot;)(string[,options])</code></h4>
<p>Renders a string to a 2D cell complex</p>
<ul>
<li><code>string</code> is a string of text (single line)</li>
<li><p><code>options</code> is an optional object of parameters</p>
<ul>
<li><code>options.font</code> is the font to use (default: <code>&quot;normal&quot;</code>)</li>
<li><code>options.triangles</code> if set, then output a triangulation</li>
<li><code>options.polygons</code> if set, output a list of polygons</li>
<li><code>options.textBaseline</code> determines the baseline, same semantics as the canvas <a href="https://developer.mozilla.org/en-US/docs/Drawing_text_using_a_canvas#Attributes">textBaseline</a> property.  Default: <code>&quot;alphabetic&quot;</code></li>
<li><code>options.textAlign</code> determines the alignment for the text, same semantics as canvas <a href="https://developer.mozilla.org/en-US/docs/Drawing_text_using_a_canvas#Attributes">textAlign</a>.  Default: <code>&quot;start&quot;</code></li>
<li><code>options.lineHeight</code> determines the height of a line.  Default: <code>1.0</code></li>
<li><code>options.width</code> determines the width of the text, overrides <code>lineHeight</code> if specified</li>
<li><code>options.height</code> determines the height of the text, overrides <code>lineHeight</code> if specified</li>
<li><code>options.orientation</code> determines the orientation of any output triangles/polygon curves.  Must be either <code>&quot;cw&quot;</code> for clockwise or <code>&quot;ccw&quot;</code> for counter clockwise.  Default is <code>&quot;cw&quot;</code>.</li>
</ul>
</li>
</ul>
<p><strong>Returns</strong> The returned value depends on the type of geometry</p>
<ul>
<li><p><em>Planar graph</em>: This is the fastest output format. A JSON object encoding the embedding of an oriented planar graph, with the following properties:</p>
<ul>
<li><code>edges</code> are the edges of the graph</li>
<li><code>positions</code> are the positions</li>
</ul>
</li>
<li><p><em>Polygon list</em>: A list of complex polygons encoded as arrays of positions.  This format is most suitable for SVG and GeoJSON output</p>
</li>
<li><p><em>Triangulation</em>: This format may be most suitable for WebGL/rendering applications. A 2D oriented simplicial complex encoded as a list of cells and positions, represented by a JSON object with two properties</p>
<ul>
<li><code>cells</code> are the faces of the triangulation, encoded as triples of indices into the vertex array</li>
<li><code>positions</code> are the positions of the vertices in the triangulation</li>
</ul>
</li>
</ul>
<p><strong>Note</strong> In node.js, this library requires Cairo.  For more information on how to set this up, look at the documentation for the <a href="https://www.npmjs.org/package/canvas">canvas module</a>.</p>
<h1 id="credits">Credits</h1>
<p>(c) 2014 Mikola Lysenko. MIT License</p>
