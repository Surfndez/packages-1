<h1 id="gl-surface-plot">gl-surface-plot</h1>
<p>Draws a surface plot</p>
<iframe scrolling="no" seamless="seamless" src="http://mikolalysenko.github.io/gl-surface-plot/"></iframe><h2 id="example">Example</h2>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">shell</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-now&quot;</span><span class="p">)({</span> <span class="nx">clearColor</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">})</span>
<span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;game-shell-orbit-camera&quot;</span><span class="p">)(</span><span class="nx">shell</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createSurfacePlot</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-surface-plot&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">ndarray</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;ndarray&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">fill</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;ndarray-fill&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">diric</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dirichlet&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">glm</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-matrix&quot;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">mat4</span> <span class="o">=</span> <span class="nx">glm</span><span class="p">.</span><span class="nx">mat4</span>

<span class="kd">var</span> <span class="nx">surface</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-init&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">gl</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">DEPTH_TEST</span><span class="p">)</span>

  <span class="c1">//Set up camera</span>
  <span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>      <span class="c1">//Eye position</span>
    <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span> <span class="c1">//Eye target</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>      <span class="c1">//Up direction</span>

  <span class="c1">//Create field</span>
  <span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="nx">ndarray</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="mi">512</span><span class="o">*</span><span class="mi">512</span><span class="p">),</span> <span class="p">[</span><span class="mi">512</span><span class="p">,</span><span class="mi">512</span><span class="p">])</span>
  <span class="nx">fill</span><span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">128</span> <span class="o">*</span> <span class="nx">diric</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10.0</span><span class="o">*</span><span class="p">(</span><span class="nx">x</span><span class="o">-</span><span class="mi">256</span><span class="p">)</span><span class="o">/</span><span class="mi">512</span><span class="p">)</span> <span class="o">*</span> <span class="nx">diric</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10.0</span><span class="o">*</span><span class="p">(</span><span class="nx">y</span><span class="o">-</span><span class="mi">256</span><span class="p">)</span><span class="o">/</span><span class="mi">512</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">surface</span> <span class="o">=</span> <span class="nx">createSurface</span><span class="p">(</span><span class="nx">gl</span><span class="p">,</span> <span class="nx">field</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">shell</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;gl-render&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">surface</span><span class="p">.</span><span class="nx">draw</span><span class="p">({</span>
    <span class="nx">view</span><span class="o">:</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">view</span><span class="p">(),</span>
    <span class="nx">projection</span><span class="o">:</span>  <span class="nx">mat4</span><span class="p">.</span><span class="nx">perspective</span><span class="p">(</span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mf">4.0</span><span class="p">,</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="nx">shell</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">10000.0</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre>
<p>Here is what this should look like:</p>
<p><img src="plot.png"></p>
<p><a href="http://mikolalysenko.github.io/gl-surface-plot/">Test it in your browser (requires WebGL)</a></p>
<h2 id="install">Install</h2>
<pre><code>npm install gl-surface-plot
</code></pre><h2 id="api">API</h2>
<pre><code class="lang-javascript"><span class="kd">var</span> <span class="nx">createSurfacePlot</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;gl-surface-plot&quot;</span><span class="p">)</span>
</code></pre>
<h3 id="-var-surface-createsurfaceplot-gl-field-params-"><code>var surface = createSurfacePlot(gl, field[, params])</code></h3>
<p>Creates a surface plot object</p>
<ul>
<li><code>gl</code> is a WebGL context</li>
<li><code>field</code> is a 2D ndarray</li>
<li><p><code>params</code> is an optional collection of arguments that contains any of the following:</p>
<ul>
<li><code>colormap</code> - the name of the color map to use for the surface (default &quot;jet&quot;)</li>
<li><code>pickId</code> is the picking id for the surface</li>
</ul>
</li>
</ul>
<p><strong>Returns</strong> A surface object</p>
<h3 id="-surface-update-params-"><code>surface.update(params)</code></h3>
<p>Updates the surface.  The parameter object may contain any of the following properties:</p>
<ul>
<li><code>field</code> a new 2D field encoded as an ndarray</li>
<li><code>colormap</code> the name of the new color map for the surface</li>
<li><code>pickId</code> is the picking id for the surface</li>
<li><code>ticks</code> is a pair of arrays of ticks representing the spacing of the points for the axes of the surface</li>
<li><code>showSurface</code> if set, draw the surface</li>
<li><code>showContour</code> if set, draw contour lines</li>
<li><code>contourWidth</code> the width fo the contour lines</li>
<li><code>contourTint</code> the amount of tint of the contour lines</li>
<li><code>contourColor</code> the color of the contour line tint</li>
<li><code>levels</code> an array of arrays representing the level of the isolines.</li>
<li><code>dynamicWidth</code> the width of the dynamic isolines</li>
<li><code>dynamicColors</code> the color of the dynamic isolines</li>
<li><code>dynamicTint</code> the tint of the dynamic isolines</li>
</ul>
<h3 id="-surface-draw-params-"><code>surface.draw([params])</code></h3>
<p>Draws the surface.  Accepts the following parameters</p>
<ul>
<li><code>model</code> the 4x4 model matrix (in gl-matrix format)</li>
<li><code>view</code> the 4x4 view matrix</li>
<li><code>projection</code> the 4x4 projection matrix</li>
</ul>
<h3 id="-surface-dispose-"><code>surface.dispose()</code></h3>
<p>Destroys the surface, releases all associated WebGL resources</p>
<h3 id="-surface-bounds-"><code>surface.bounds</code></h3>
<p>A pair of 3D arrays representing the lower/upper bounding box for the surface plot.</p>
<h3 id="-surface-clipbounds-"><code>surface.clipBounds</code></h3>
<p>A pair of arrays which bound the coordinates of the surface plot in 3D.</p>
<h2 id="interactivity-picking">Interactivity/picking</h2>
<h3 id="-surface-drawpick-camera-"><code>surface.drawPick(camera)</code></h3>
<p>Draws the surface for point picking mode</p>
<h3 id="-surface-pick-selection-"><code>surface.pick(selection)</code></h3>
<p>Test if the given selection is contained in the surface.  If true, returns an object encoding the selected point.</p>
<p><strong>Returns</strong> An object encoding the selected point on the surface with the following properties:</p>
<ul>
<li><code>position</code> which is the position of the selected point on the surface</li>
<li><code>index</code> a vector encoding the [x,y] index of the closest data point</li>
<li><code>uv</code> the uv coordinate of the selection</li>
<li><code>levels</code> the closest levels to the selection</li>
</ul>
<h3 id="-surface-dynamic-levels-"><code>surface.dynamic(levels)</code></h3>
<p>Toggles drawing level isolines and their projections.</p>
<ul>
<li><code>levels</code> is an array of 3 arrays representing the x/y/z levels to draw</li>
</ul>
<h2 id="lighting-parameters">Lighting parameters</h2>
<p>You can also tweak the lighting parameters for the surface using the following variables</p>
<h3 id="-surface-lightposition-"><code>surface.lightPosition</code></h3>
<p>The position of the light source relative to the viewer in clip coordinates</p>
<h3 id="-surface-ambientlight-"><code>surface.ambientLight</code></h3>
<p>The fraction of light which is ambiently lit</p>
<h3 id="-surface-diffuselight-"><code>surface.diffuseLight</code></h3>
<p>The amount of diffuse light to apply to the surface</p>
<h3 id="-surface-specularlight-"><code>surface.specularLight</code></h3>
<p>THe amount of speculare light to apply to the surface</p>
<h3 id="-surface-roughness-"><code>surface.roughness</code></h3>
<p>How rough the surface is  (must be between 0 and 1)</p>
<h3 id="-surface-fresnel-"><code>surface.fresnel</code></h3>
<p>The amount of rim lighting to apply.  Higher values = more intense rim light.</p>
<h2 id="license">License</h2>
<p>MIT License.</p>
