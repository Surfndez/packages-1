<h1 id="canvas-loop"><a target="_blank" href="http://github.com/mattdesl/canvas-loop">canvas-loop</a></h1>
<p><a href="http://github.com/badges/stability-badges"></a></p>
<p><iframe scrolling="no" seamless="seamless" src="http://mattdesl.github.io/canvas-loop/"></iframe></p>
<p><a href="http://mattdesl.github.io/canvas-loop/">demo</a> - <a href="demo.es6">source</a></p>
<p>Yet another canvas shell utility, built on <a href="https://npmjs.org/package/canvas-fit">canvas-fit</a> and <a href="https://npmjs.org/package/raf-loop">raf-loop</a>. Useful for full-screen retina canvas demos.</p>
<p>Example:</p>
<pre><code class="lang-js"><span class="kd">var</span> <span class="nx">createGL</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;webgl-context&apos;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">createLoop</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;canvas-loop&apos;</span><span class="p">)</span>

<span class="c1">// get a WebGL context</span>
<span class="kd">var</span> <span class="nx">gl</span> <span class="o">=</span> <span class="nx">createGL</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">canvas</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">canvas</span><span class="p">)</span>

<span class="c1">// setup a retina-scaled canvas</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">createLoop</span><span class="p">(</span><span class="nx">canvas</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">scale</span><span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span>
<span class="p">})</span>

<span class="c1">// start rendering</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>

<span class="c1">// on requestAnimationFrame</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&apos;tick&apos;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dt</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// do some rendering</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">COLOR_BUFFER_BIT</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// handle window resize</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&apos;resize&apos;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// the unscaled size</span>
  <span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;new canvas size&apos;</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
<span class="p">})</span>
</code></pre>
<p>See <a href="demo.es6">demo.es6</a> for a full demo.</p>
<h2 id="usage">Usage</h2>
<p><a href="https://www.npmjs.com/package/canvas-loop"></a></p>
<h4 id="-app-createloop-canvas-opt-"><code>app = createLoop(canvas[, opt])</code></h4>
<p>Creates a new loop with the given <code>canvas</code> (can be <a href="https://www.npmjs.com/package/2d-context">2D</a> or <a href="https://www.npmjs.com/package/webgl-context">WebGL</a>). </p>
<p>The options:</p>
<ul>
<li><code>parent</code> element to fit to, or a scaling function (default <code>window</code>)</li>
<li><code>scale</code> scaling ratio for canvas (default 1)</li>
</ul>
<p>These options are passed to <a href="https://github.com/hughsk/canvas-fit/">canvas-fit</a>.</p>
<h4 id="-app-start-"><code>app.start()</code></h4>
<h4 id="-app-stop-"><code>app.stop()</code></h4>
<p>Start and stop the render loop. Returns the <code>app</code> for chaining.</p>
<h4 id="-app-on-tick-fn-"><code>app.on(&apos;tick&apos;, fn)</code></h4>
<p>Listen to <code>tick</code> events, <code>fn</code> is called with <code>dt</code> parameter which is the delta time since last frame. Uses <a href="https://www.npmjs.com/package/raf-loop">raf-loop</a>.</p>
<h4 id="-app-on-resize-fn-"><code>app.on(&apos;resize&apos;, fn)</code></h4>
<p>Called when the <code>window</code> has resized, after the canvas has been re-scaled according to its <code>parent</code>.</p>
<h4 id="-app-shape-"><code>app.shape</code></h4>
<p>A getter for the <code>[ width, height ]</code> of the canvas <em>without</em> device scaling. This is the same as:</p>
<pre><code>[ canvas.width / app.scale, canvas.height / app.scale ]
</code></pre><h4 id="-app-parent-"><code>app.parent</code></h4>
<h4 id="-app-scale-"><code>app.scale</code></h4>
<p>Getters/setters to change <code>parent</code> or <code>scale</code> at runtime. See <a href="https://www.npmjs.com/package/canvas-fit">canvas-fit</a> for details.</p>
<h2 id="license">License</h2>
<p>MIT, see <a href="http://github.com/mattdesl/canvas-loop/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
