<h1 id="perspective-camera"><a target="_blank" href="http://github.com/Jam3/perspective-camera">perspective-camera</a></h1>
<p><a href="http://github.com/badges/stability-badges"></a></p>
<p><iframe scrolling="no" seamless="seamless" src="http://jam3.github.io/perspective-camera/"></iframe></p>
<p><a href="http://jam3.github.io/perspective-camera/">demo</a> - <a href="demo/canvas.js">source</a></p>
<p>A high-level 3D perspective camera with a familiar and convenient interface, built from modular pieces.</p>
<pre><code class="lang-js"><span class="kd">var</span> <span class="nx">createCamera</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&apos;perspective-camera&apos;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="nx">createCamera</span><span class="p">({</span>
  <span class="nx">fov</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
  <span class="nx">near</span><span class="o">:</span> <span class="mf">0.01</span><span class="p">,</span>
  <span class="nx">far</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
  <span class="nx">viewport</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1">//set up our camera</span>
<span class="nx">camera</span><span class="p">.</span><span class="nx">translate</span><span class="p">([</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span> <span class="p">])</span>
<span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">])</span>
<span class="nx">camera</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>

<span class="c1">//do some 3D hit-testing</span>
<span class="kd">var</span> <span class="nx">ray</span> <span class="o">=</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">createPickingRay</span><span class="p">(</span><span class="nx">mouseInput</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">ray</span><span class="p">.</span><span class="nx">intersectsSphere</span><span class="p">(</span><span class="nx">center</span><span class="p">,</span> <span class="nx">radius</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Mouse hit 3D sphere!&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<p>See <a href="demo/canvas.js">demo/canvas.js</a> for a full example, using Canvas2D.</p>
<h2 id="usage">Usage</h2>
<p><a href="https://www.npmjs.com/package/perspective-camera"></a></p>
<h4 id="-camera-createcamera-opts-"><code>camera = createCamera([opts])</code></h4>
<p>Creates a new camera with options:</p>
<ul>
<li><code>fov</code> field of view in radians, default <code>Math.PI / 4</code></li>
<li><code>far</code> the far range, default <code>100</code></li>
<li><code>near</code> the near range, default <code>1 / 100</code></li>
<li><code>position</code> the camera position, default <code>[0, 0, 0]</code></li>
<li><code>direction</code> the camera direction, default <code>[0, 0, -1]</code></li>
<li><code>up</code> the camera up vector, default <code>[0, 1, 0]</code></li>
<li><code>viewport</code> the screen-space viewport bounds, default <code>[-1, -1, 1, 1]</code></li>
</ul>
<p>The <code>viewport</code> is used to determine the aspect ratio of the projection, as well as projecting and ray-picking.</p>
<h2 id="methods">methods</h2>
<h4 id="-camera-update-"><code>camera.update()</code></h4>
<p>Updates the camera projection and view matrices from the camera&apos;s current state (position, direction, viewport, etc). </p>
<h4 id="-camera-identity-"><code>camera.identity()</code></h4>
<p>Resets the <code>position</code>, <code>direction</code>, <code>up</code>, <code>projection</code> and <code>view</code> values to their identity; the defaults described in the constructor.</p>
<h4 id="-camera-translate-vec3-"><code>camera.translate(vec3)</code></h4>
<p>Translates this camera&apos;s <code>position</code> by the given <code>vec3</code>.</p>
<h4 id="-camera-lookat-vec3-"><code>camera.lookAt(vec3)</code></h4>
<p>Updates the <code>direction</code> and <code>up</code> to look at the given <code>vec3</code> target.</p>
<h4 id="-camera-project-vec3-"><code>camera.project(vec3)</code></h4>
<p><a href="https://github.com/Jam3/camera-project">Projects</a> the world space 3D point <code>vec3</code> into 2D screen-space based on this camera&apos;s <code>viewport</code> bounds. Returns a new <code>vec4</code> point with <code>z</code> and <code>w</code> components representing the computed depth (similar to <code>gl_FragCoord</code>).</p>
<h4 id="-camera-unproject-vec3-"><code>camera.unproject(vec3)</code></h4>
<p><a href="https://github.com/Jam3/camera-unproject">Unprojects</a> the screen-space point into 3D world-space. The Z of the screen-space point is between 0 (near plane) and 1 (far plane).</p>
<h4 id="-camera-createpickingray-vec2-"><code>camera.createPickingRay(vec2)</code></h4>
<p>Creates a new picking ray from the 2D screen-space <code>vec2</code> point (i.e. the mouse).</p>
<p>The ray is an instance of <a href="https://github.com/Jam3/ray-3d">ray-3d</a>, and it can be used for hit-testing.</p>
<pre><code class="lang-js"><span class="kd">var</span> <span class="nx">ray</span> <span class="o">=</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">createPickingRay</span><span class="p">(</span><span class="nx">mouse</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">ray</span><span class="p">.</span><span class="nx">intersectsSphere</span><span class="p">(</span><span class="nx">center</span><span class="p">,</span> <span class="nx">radius</span><span class="p">))</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Hit!&quot;</span><span class="p">)</span>
</code></pre>
<h2 id="properties">properties</h2>
<h4 id="-camera-viewport-"><code>camera.viewport</code></h4>
<p>A <code>[x, y, width, height]</code> array defining the viewport in screen space.</p>
<h4 id="-camera-projection-camera-view-"><code>camera.projection</code>, <code>camera.view</code></h4>
<p>The 4x4 projection and view matrices, computed after a call to <code>update()</code>. </p>
<h4 id="-camera-position-camera-direction-camera-up-"><code>camera.position</code>, <code>camera.direction</code>, <code>camera.up</code></h4>
<p>The current position, direction, and up vectors.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="https://www.npmjs.com/package/camera-unproject">camera-unproject</a></li>
<li><a href="https://www.npmjs.com/package/camera-project">camera-project</a></li>
<li><a href="https://www.npmjs.com/package/camera-picking-ray">camera-picking-ray</a></li>
<li><a href="https://www.npmjs.com/package/ray-3d">ray-3d</a></li>
<li><a href="https://www.npmjs.com/package/ray-sphere-intersection">ray-sphere-intersection</a></li>
<li><a href="https://www.npmjs.com/package/ray-plane-intersection">ray-plane-intersection</a></li>
<li><a href="https://www.npmjs.com/package/ray-triangle-intersection">ray-triangle-intersection</a></li>
</ul>
<h2 id="license">License</h2>
<p>MIT, see <a href="http://github.com/Jam3/perspective-camera/blob/master/LICENSE.md">LICENSE.md</a> for details.</p>
